CREATE USER SA PASSWORD "" ADMIN
/*C1*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C2*/SET SCHEMA PUBLIC
CONNECT USER SA
create table Authority (id bigint generated by default as identity (start with 1), role varchar(255), primary key (id))
create table Building (id bigint generated by default as identity (start with 1), active bit not null, comment varchar(255), name varchar(255), title varchar(255), primary key (id))
create table Floor (id bigint generated by default as identity (start with 1), active bit not null, comment varchar(255), name varchar(255), title varchar(255), building_id bigint, primary key (id))
create table Reservation (id bigint generated by default as identity (start with 1), comment varchar(255), endDateTime timestamp, startDateTime timestamp, room_id bigint, user_id bigint, primary key (id))
create table Room (id bigint generated by default as identity (start with 1), active bit not null, attributes varchar(255), comment varchar(255), name varchar(255), title varchar(255), floor_id bigint, primary key (id))
create table User (id bigint generated by default as identity (start with 1), adminStatus varchar(255), birthday timestamp, email varchar(255), enabled bit not null, firstName varchar(255), lastName varchar(255), password varchar(255), phone varchar(255), username varchar(255), defaultFloor_id bigint, primary key (id))
create table User_Authority (User_id bigint not null, roles_id bigint not null, primary key (User_id, roles_id))
create table User_Room (administrators_id bigint not null, administeredRooms_id bigint not null, primary key (administrators_id, administeredRooms_id))
alter table Floor add constraint FK40D33EC69A6F4D6 foreign key (building_id) references Building
alter table Reservation add constraint FK63EEBAC9F1A1D76 foreign key (room_id) references Room
alter table Reservation add constraint FK63EEBAC4416F776 foreign key (user_id) references User
alter table Room add constraint FK26F4FBC662FC1E foreign key (floor_id) references Floor
alter table User add constraint FK285FEB39A1015F foreign key (defaultFloor_id) references Floor
alter table User_Authority add constraint FKF114D7CF4416F776 foreign key (User_id) references User
alter table User_Authority add constraint FKF114D7CFA1571904 foreign key (roles_id) references Authority
alter table User_Room add constraint FK8B9F88CF198CF6A0 foreign key (administeredRooms_id) references Room
alter table User_Room add constraint FK8B9F88CF37C9561B foreign key (administrators_id) references User
/*C3*/SET SCHEMA PUBLIC
CONNECT USER SA
INSERT INTO USER VALUES(1,NULL,NULL,NULL,TRUE,'FN','LN','admin',NULL,'admin',NULL)
INSERT INTO AUTHORITY VALUES(1,'ROLE_APP-ADMIN')
INSERT INTO AUTHORITY VALUES(2,'ROLE_ROOM-ADMIN')
INSERT INTO AUTHORITY VALUES(3,'ROLE_USER')
INSERT INTO USER VALUES(2,NULL,NULL,NULL,TRUE,'FN','LN','admin',NULL,'admin',NULL)
INSERT INTO AUTHORITY VALUES(4,'ROLE_APP-ADMIN')
INSERT INTO AUTHORITY VALUES(5,'ROLE_ROOM-ADMIN')
INSERT INTO AUTHORITY VALUES(6,'ROLE_USER')
INSERT INTO USER_AUTHORITY VALUES(1,1)
DISCONNECT
/*C2*/SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
DELETE FROM USER WHERE ID=2
COMMIT
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
INSERT INTO USER VALUES(3,NULL,NULL,'u',TRUE,'u','u','user','u','user',NULL)
INSERT INTO USER_AUTHORITY VALUES(3,3)
COMMIT
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
DISCONNECT
/*C4*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C5*/SET SCHEMA PUBLIC
CONNECT USER SA
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
SET AUTOCOMMIT FALSE
SET AUTOCOMMIT TRUE
